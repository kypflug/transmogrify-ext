<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Transmogrifier</title>
    <link rel="stylesheet" href="popup.css" />
  </head>
  <body>
    <div class="popup-container">
      <!-- Top bar -->
      <div class="popup-top-bar">
        <span class="top-bar-brand">ðŸ“¦ Transmogrifier</span>
        <button class="library-btn" id="openLibraryBtn" title="Open Library">ðŸ“– Library</button>
      </div>

      <!-- Main content -->
      <div class="remix-view">
        <!-- Scrollable content area -->
        <div class="remix-scroll-area">
          <header class="popup-header">
            <span class="status-indicator" id="statusIndicator">Ready</span>
          </header>

          <!-- Active Remixes Section -->
          <section class="active-remixes-section" id="activeRemixesSection" style="display: none;">
            <h2>Active Jobs <span class="active-count" id="activeCount"></span> <a href="#" id="clearStuck" class="clear-stuck-link">Clear stuck</a></h2>
            <div class="active-remixes-list" id="activeRemixesList">
              <!-- Populated by JS -->
            </div>
          </section>

          <section class="recipe-selector">
            <h2>Choose a Recipe</h2>
            <div class="recipe-list" id="recipeList">
              <!-- Recipes populated by JS -->
            </div>
          </section>

          <section class="custom-prompt-section" id="customPromptSection" style="display: none;">
            <h2>Custom Instructions</h2>
            <textarea 
              id="customPrompt" 
              placeholder="Tell the AI how you want this page transformed...

Examples:
â€¢ Hide all images and focus on text
â€¢ Remove everything except the main article and code blocks
â€¢ Make it look like a minimal documentation page
â€¢ Add a hero image that captures the article theme"
            ></textarea>
          </section>

          <section class="explanation-section" id="explanationSection" style="display: none;">
            <h2>AI Explanation</h2>
            <p id="explanationText"></p>
          </section>
        </div>

        <!-- Pinned footer area -->
        <div class="remix-actions">
          <section class="image-toggle-section" id="imageToggleSection">
            <label class="image-toggle">
              <input type="checkbox" id="generateImages" />
              <span class="toggle-slider"></span>
              <span class="toggle-label">
                <span class="toggle-icon">ðŸŽ¨</span>
                Generate AI Images
              </span>
            </label>
          </section>

          <footer class="popup-footer">
            <div class="btn-group">
              <button id="remixReadBtn" class="primary-btn">
                <span class="btn-text">âœ¨ Transmogrify &amp; Read</span>
              </button>
              <button id="remixSendBtn" class="secondary-send-btn" title="Start transmogrification without navigating">
                <span class="btn-text">ðŸ“¥ Send to Library</span>
              </button>
            </div>
          </footer>
        </div>
      </div>
    </div>

    <script type="module" src="popup.ts"></script>
  </body>
</html>