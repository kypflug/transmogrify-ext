<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Settings ‚Äî Transmogrifier</title>
  <link rel="stylesheet" href="settings.css">
</head>
<body>
  <div class="settings-layout">
    <!-- Header bar -->
    <header class="settings-header">
      <div class="header-left">
        <span class="header-icon">‚öôÔ∏è</span>
        <h1>Transmogrifier Settings</h1>
      </div>
      <div class="header-right">
        <span class="save-indicator hidden" id="saveIndicator">‚úì Saved</span>
        <button class="header-btn" id="backBtn" title="Back to Library">‚Üê Library</button>
      </div>
    </header>

    <!-- Scrollable content -->
    <main class="settings-content">

      <!-- AI Provider Section -->
      <section class="settings-section" id="aiSection">
        <div class="section-header">
          <h2>ü§ñ AI Provider</h2>
          <span class="section-badge" id="aiBadge">Not configured</span>
        </div>
        <p class="section-desc">
          Configure the AI provider used for transmogrification.
          Your keys are encrypted at rest and never leave your device unencrypted.
        </p>

        <div class="field-row">
          <label for="aiProvider">Provider</label>
          <select id="aiProvider">
            <option value="azure-openai">Azure OpenAI</option>
            <option value="openai">OpenAI</option>
            <option value="anthropic">Anthropic Claude</option>
            <option value="google">Google Gemini</option>
          </select>
        </div>

        <!-- Azure OpenAI fields -->
        <div class="provider-fields" id="aiAzureFields">
          <div class="field-row">
            <label for="aiAzureEndpoint">Endpoint</label>
            <input type="url" id="aiAzureEndpoint" placeholder="https://your-resource.openai.azure.com">
          </div>
          <div class="field-row">
            <label for="aiAzureKey">API Key</label>
            <input type="password" id="aiAzureKey" placeholder="Azure OpenAI API key" autocomplete="off">
          </div>
          <div class="field-row">
            <label for="aiAzureDeployment">Deployment</label>
            <input type="text" id="aiAzureDeployment" placeholder="gpt-4o">
          </div>
          <div class="field-row">
            <label for="aiAzureVersion">API Version</label>
            <input type="text" id="aiAzureVersion" placeholder="2024-10-21">
          </div>
        </div>

        <!-- OpenAI fields -->
        <div class="provider-fields hidden" id="aiOpenaiFields">
          <div class="field-row">
            <label for="aiOpenaiKey">API Key</label>
            <input type="password" id="aiOpenaiKey" placeholder="sk-‚Ä¶" autocomplete="off">
          </div>
          <div class="field-row">
            <label for="aiOpenaiModel">Model</label>
            <input type="text" id="aiOpenaiModel" placeholder="gpt-4o">
          </div>
        </div>

        <!-- Anthropic fields -->
        <div class="provider-fields hidden" id="aiAnthropicFields">
          <div class="field-row">
            <label for="aiAnthropicKey">API Key</label>
            <input type="password" id="aiAnthropicKey" placeholder="sk-ant-‚Ä¶" autocomplete="off">
          </div>
          <div class="field-row">
            <label for="aiAnthropicModel">Model</label>
            <input type="text" id="aiAnthropicModel" placeholder="claude-sonnet-4-20250514">
          </div>
        </div>

        <!-- Google fields -->
        <div class="provider-fields hidden" id="aiGoogleFields">
          <div class="field-row">
            <label for="aiGoogleKey">API Key</label>
            <input type="password" id="aiGoogleKey" placeholder="Google API key" autocomplete="off">
          </div>
          <div class="field-row">
            <label for="aiGoogleModel">Model</label>
            <input type="text" id="aiGoogleModel" placeholder="gemini-2.0-flash">
          </div>
        </div>
      </section>

      <!-- Image Provider Section -->
      <section class="settings-section" id="imageSection">
        <div class="section-header">
          <h2>üé® Image Provider</h2>
          <span class="section-badge" id="imageBadge">None</span>
        </div>
        <p class="section-desc">
          Configure AI image generation for illustrated recipes.
        </p>

        <div class="field-row">
          <label for="imageProvider">Provider</label>
          <select id="imageProvider">
            <option value="none">None (disabled)</option>
            <option value="azure-openai">Azure OpenAI</option>
            <option value="openai">OpenAI</option>
            <option value="google">Google Gemini</option>
          </select>
        </div>

        <!-- Azure OpenAI Image fields -->
        <div class="provider-fields hidden" id="imgAzureFields">
          <div class="field-row">
            <label for="imgAzureEndpoint">Endpoint</label>
            <input type="url" id="imgAzureEndpoint" placeholder="https://your-resource.openai.azure.com">
          </div>
          <div class="field-row">
            <label for="imgAzureKey">API Key</label>
            <input type="password" id="imgAzureKey" placeholder="Azure OpenAI API key" autocomplete="off">
          </div>
          <div class="field-row">
            <label for="imgAzureDeployment">Deployment</label>
            <input type="text" id="imgAzureDeployment" placeholder="gpt-image-1">
          </div>
          <div class="field-row">
            <label for="imgAzureVersion">API Version</label>
            <input type="text" id="imgAzureVersion" placeholder="2024-10-21">
          </div>
        </div>

        <!-- OpenAI Image fields -->
        <div class="provider-fields hidden" id="imgOpenaiFields">
          <div class="field-row">
            <label for="imgOpenaiKey">API Key</label>
            <input type="password" id="imgOpenaiKey" placeholder="sk-‚Ä¶" autocomplete="off">
          </div>
          <div class="field-row">
            <label for="imgOpenaiModel">Model</label>
            <input type="text" id="imgOpenaiModel" placeholder="gpt-image-1">
          </div>
        </div>

        <!-- Google Image fields -->
        <div class="provider-fields hidden" id="imgGoogleFields">
          <div class="field-row">
            <label for="imgGoogleKey">API Key</label>
            <input type="password" id="imgGoogleKey" placeholder="Google API key" autocomplete="off">
          </div>
          <div class="field-row">
            <label for="imgGoogleModel">Model</label>
            <input type="text" id="imgGoogleModel" placeholder="gemini-2.5-flash-image">
          </div>
        </div>
      </section>



      <!-- Sharing (BYOS) Section -->
      <section class="settings-section" id="sharingSection">
        <div class="section-header">
          <h2>üîó Article Sharing</h2>
          <span class="section-badge" id="sharingBadge">Disabled</span>
        </div>
        <p class="section-desc">
          Share articles via public links. Bring Your Own Storage (BYOS) ‚Äî articles are
          uploaded to your Azure Blob Storage account. Short links are generated via the cloud API.
        </p>

        <div class="field-row">
          <label for="sharingProvider">Storage Provider</label>
          <select id="sharingProvider">
            <option value="none">None (disabled)</option>
            <option value="azure-blob">Azure Blob Storage</option>
          </select>
        </div>

        <!-- Azure Blob fields -->
        <div class="provider-fields hidden" id="sharingAzureBlobFields">
          <div class="field-row">
            <label for="sharingAccountName">Account Name</label>
            <input type="text" id="sharingAccountName" placeholder="mystorageaccount">
          </div>
          <div class="field-row">
            <label for="sharingContainerName">Container Name</label>
            <input type="text" id="sharingContainerName" placeholder="shared-articles">
          </div>
          <div class="field-row">
            <label for="sharingSasToken">SAS Token</label>
            <input type="password" id="sharingSasToken" placeholder="sv=2024-11-04&ss=b&srt=co&sp=rwdl‚Ä¶" autocomplete="off">
          </div>
          <p class="section-desc" style="margin-top: 0.5rem; font-size: 0.8rem;">
            Create a storage account ‚Üí add a container with <strong>Blob</strong> public access level ‚Üí
            generate a SAS token (Blob service, Container+Object permissions, Read+Write+Delete, HTTPS only) ‚Üí
            add a CORS rule for <code>https://transmogrifia.app</code> (GET method).
          </p>
        </div>
      </section>

      <!-- Sync Section -->
      <section class="settings-section" id="syncSection">
        <div class="section-header">
          <h2>üîÑ Settings Sync</h2>
          <span class="section-badge" id="syncBadge">Local only</span>
        </div>
        <p class="section-desc">
          Sync your encrypted settings to OneDrive so they're available on all your devices.
          Requires signing in to your Microsoft account.
        </p>

        <div class="sync-actions">
          <button class="btn btn-secondary" id="pushSettingsBtn" title="Upload settings to OneDrive">
            ‚¨ÜÔ∏è Push to Cloud
          </button>
          <button class="btn btn-secondary" id="pullSettingsBtn" title="Download settings from OneDrive">
            ‚¨áÔ∏è Pull from Cloud
          </button>
        </div>
        <p class="sync-status" id="syncStatus"></p>
      </section>

      <!-- Danger Zone -->
      <section class="settings-section danger-section">
        <div class="section-header">
          <h2>‚ö†Ô∏è Danger Zone</h2>
        </div>
        <div class="field-actions">
          <button class="btn btn-danger" id="clearSettingsBtn">Clear All Settings</button>
        </div>
      </section>

    </main>
  </div>

  <script type="module" src="settings.ts"></script>
</body>
</html>
