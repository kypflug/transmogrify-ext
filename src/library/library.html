<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Transmogrifications</title>
  <link rel="stylesheet" href="library.css">
</head>
<body>
  <div class="library-layout">
    <!-- Sidebar -->
    <aside class="sidebar" id="sidebar">
      <header class="sidebar-header">
        <div class="sidebar-brand">
          <span class="brand-icon">ğŸ“¦</span>
          <h1>Transmogrifier Library</h1>
        </div>
      </header>

      <div class="sidebar-controls">
        <div class="search-box">
          <span class="search-icon">ğŸ”</span>
          <input type="text" id="searchInput" placeholder="Search articlesâ€¦" autocomplete="off">
          <button class="search-clear hidden" id="searchClear" title="Clear search">âœ•</button>
        </div>

        <div class="filter-row">
          <select id="filterSelect" title="Filter articles">
            <option value="all">All Articles</option>
            <option value="favorites">â˜… Favorites</option>
            <!-- Recipe filters populated by JS -->
          </select>

          <select id="sortSelect" title="Sort articles">
            <option value="newest">Newest first</option>
            <option value="oldest">Oldest first</option>
            <option value="alpha">A â†’ Z</option>
          </select>
        </div>
      </div>

      <div class="article-list" id="articleList">
        <!-- Populated by JS -->
      </div>

      <footer class="sidebar-footer" id="sidebarFooter">
        <!-- e.g. "12 articles Â· 4.2 MB" -->
      </footer>

      <!-- Sync status bar -->
      <div class="sync-bar" id="syncBar">
        <span class="sync-bar-icon" id="syncBarIcon">â˜ï¸</span>
        <span class="sync-bar-text" id="syncBarText">Sign in to sync</span>
        <button class="sync-bar-btn" id="syncBarBtn" title="Sync now">ğŸ”„</button>
        <button class="sync-bar-btn hidden" id="syncBarSignOut" title="Sign out">â</button>
      </div>

      <!-- Empty state -->
      <div class="sidebar-empty hidden" id="sidebarEmpty">
        <div class="empty-icon">ğŸ“„</div>
        <p class="empty-title">No transmogrifications yet</p>
        <p class="empty-hint">Visit any web page and click Transmogrify to get started</p>
      </div>
    </aside>

    <!-- Resize handle -->
    <div class="resize-handle" id="resizeHandle" title="Drag to resize"></div>

    <!-- Reading pane -->
    <main class="reading-pane" id="readingPane">
      <!-- No-selection placeholder -->
      <div class="reading-empty" id="readingEmpty">
        <div class="reading-empty-icon">ğŸ“–</div>
        <p>Select an article to read</p>
      </div>

      <!-- In-progress transmogrification -->
      <div class="reading-progress hidden" id="readingProgress">
        <div class="progress-card">
          <div class="progress-spinner-lg"></div>
          <h2 class="progress-page-title" id="progressTitle">Transmogrifyingâ€¦</h2>
          <div class="progress-recipe" id="progressRecipe"></div>
          <div class="progress-step" id="progressStep">Startingâ€¦</div>
          <div class="progress-elapsed" id="progressElapsed"></div>
          <button class="progress-cancel-btn" id="progressCancel">Cancel</button>
        </div>
      </div>

      <!-- Article view -->
      <div class="reading-article hidden" id="readingArticle">
        <header class="article-header">
          <div class="article-meta">
            <h2 class="article-title" id="readingTitle">Untitled</h2>
            <div class="article-info" id="readingInfo">
              <!-- source Â· recipe Â· date -->
            </div>
          </div>
          <div class="article-actions">
            <button class="action-btn" id="btnFavorite" title="Toggle favorite">
              <span id="favoriteIcon">â˜†</span>
              <span class="action-label">Favorite</span>
            </button>
            <button class="action-btn" id="btnExport" title="Save to file">
              ğŸ’¾ <span class="action-label">Save</span>
            </button>
            <button class="action-btn" id="btnOriginal" title="Open original page">
              ğŸ”— <span class="action-label">Original</span>
            </button>
            <button class="action-btn" id="btnNewTab" title="Open in new tab">
              â†—ï¸ <span class="action-label">New Tab</span>
            </button>
            <button class="action-btn" id="btnRespin" title="Respin with different recipe">
              ğŸ”„ <span class="action-label">Respin</span>
            </button>
            <button class="action-btn danger" id="btnDelete" title="Delete article">
              ğŸ—‘ï¸
            </button>
          </div>
        </header>

        <iframe id="contentFrame" class="content-frame" sandbox="allow-same-origin allow-scripts"></iframe>
      </div>
    </main>
  </div>

  <!-- Respin Modal -->
  <div id="respinModal" class="modal-overlay hidden">
    <div class="modal">
      <div class="modal-header">
        <h3>ğŸ”„ Respin Article</h3>
      </div>
      <div class="modal-body">
        <div class="modal-section">
          <label>Choose a Recipe</label>
          <div class="recipe-select" id="recipeSelect">
            <!-- Populated by JS -->
          </div>
        </div>
        <div class="modal-section" id="customPromptSection" style="display: none;">
          <label>Custom Instructions</label>
          <textarea class="custom-prompt-input" id="customPromptInput" placeholder="Tell the AI how you want this page transformed..."></textarea>
        </div>
        <div class="modal-section">
          <label>Options</label>
          <div class="image-toggle-row">
            <input type="checkbox" id="generateImagesCheck">
            <span>ğŸ¨ Generate AI Images</span>
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <button class="modal-btn cancel" id="cancelRespinBtn">Cancel</button>
        <button class="modal-btn primary" id="confirmRespinBtn">âœ¨ Respin</button>
      </div>
    </div>
  </div>

  <!-- Delete confirmation -->
  <div id="deleteModal" class="modal-overlay hidden">
    <div class="modal modal-sm">
      <div class="modal-header danger">
        <h3>ğŸ—‘ï¸ Delete Article</h3>
      </div>
      <div class="modal-body">
        <p>Delete "<span id="deleteArticleTitle"></span>"? This cannot be undone.</p>
      </div>
      <div class="modal-footer">
        <button class="modal-btn cancel" id="cancelDeleteBtn">Cancel</button>
        <button class="modal-btn danger" id="confirmDeleteBtn">Delete</button>
      </div>
    </div>
  </div>

  <!-- Keyboard shortcut legend -->
  <div class="shortcut-legend" id="shortcutLegend">
    <div class="shortcut-row"><kbd>j</kbd><kbd>k</kbd> <span>prev / next</span></div>
    <div class="shortcut-row"><kbd>f</kbd> <span>favorite</span></div>
    <div class="shortcut-row"><kbd>Del</kbd> <span>delete</span></div>
    <div class="shortcut-row"><kbd>/</kbd> <span>search</span></div>
  </div>

  <!-- Mobile back button (shown < 900px) -->
  <button class="mobile-back hidden" id="mobileBack" title="Back to list">â† Back</button>

  <script src="library.js" type="module"></script>
</body>
</html>
