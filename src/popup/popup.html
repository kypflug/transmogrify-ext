<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Transmogrifier</title>
    <link rel="stylesheet" href="popup.css" />
  </head>
  <body>
    <div class="popup-container">
      <!-- Tab Navigation -->
      <nav class="tab-nav">
        <button class="tab-btn active" data-tab="remix">Transmogrify</button>
        <button class="tab-btn" data-tab="saved">Saved <span class="article-count" id="articleCount"></span></button>
      </nav>

      <!-- Remix Tab -->
      <div class="tab-content active" id="remixTab">
        <!-- Scrollable content area -->
        <div class="remix-scroll-area">
          <header class="popup-header">
            <h1>Transmogrifier</h1>
            <span class="status-indicator" id="statusIndicator">Ready</span>
          </header>

          <!-- Active Remixes Section -->
          <section class="active-remixes-section" id="activeRemixesSection" style="display: none;">
            <h2>Active Jobs <span class="active-count" id="activeCount"></span> <a href="#" id="clearStuck" class="clear-stuck-link">Clear stuck</a></h2>
            <div class="active-remixes-list" id="activeRemixesList">
              <!-- Populated by JS -->
            </div>
          </section>

          <section class="recipe-selector">
            <h2>Choose a Recipe</h2>
            <div class="recipe-list" id="recipeList">
              <!-- Recipes populated by JS -->
            </div>
          </section>

          <section class="custom-prompt-section" id="customPromptSection" style="display: none;">
            <h2>Custom Instructions</h2>
            <textarea 
              id="customPrompt" 
              placeholder="Tell the AI how you want this page transformed...

Examples:
â€¢ Hide all images and focus on text
â€¢ Remove everything except the main article and code blocks
â€¢ Make it look like a minimal documentation page
â€¢ Add a hero image that captures the article theme"
            ></textarea>
          </section>

          <section class="explanation-section" id="explanationSection" style="display: none;">
            <h2>AI Explanation</h2>
            <p id="explanationText"></p>
          </section>
        </div>

        <!-- Pinned footer area -->
        <div class="remix-actions">
          <section class="image-toggle-section" id="imageToggleSection">
            <label class="image-toggle">
              <input type="checkbox" id="generateImages" />
              <span class="toggle-slider"></span>
              <span class="toggle-label">
                <span class="toggle-icon">ðŸŽ¨</span>
                Generate AI Images
              </span>
            </label>
          </section>

          <footer class="popup-footer">
            <button id="remixBtn" class="primary-btn">
              <span class="btn-text">Transmogrify â†’ New Tab</span>
            </button>
          </footer>
        </div>
      </div>

      <!-- Saved Articles Tab -->
      <div class="tab-content" id="savedTab">
        <header class="saved-header">
          <h2>Saved Articles</h2>
          <div class="saved-header-actions">
            <span class="storage-info" id="storageInfo"></span>
            <button class="library-btn" id="openLibraryBtn" title="Open Library">ðŸ“–</button>
          </div>
        </header>
        
        <div class="articles-list" id="articlesList">
          <!-- Populated by JS -->
        </div>
        
        <div class="empty-state" id="emptyState" style="display: none;">
          <div class="empty-icon">ðŸ“„</div>
          <p>No saved articles yet</p>
          <p class="empty-hint">Use the Transmogrify tab to transform pages</p>
        </div>
      </div>
    </div>

    <script type="module" src="popup.ts"></script>
  </body>
</html>